<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PRIMA CRM</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* === –°–¢–ò–õ–ò === */
        body {
            background-color: #000;
            color: #fff;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
        }

        #app {
            width: 100%;
            max-width: 480px;
            background-color: #111;
            display: flex;
            flex-direction: column;
            position: relative;
            border-left: 1px solid #333;
            border-right: 1px solid #333;
        }

        /* –°–∫—Ä–æ–ª–ª –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            padding-bottom: 100px;
            display: none;
        }
        .content.active { display: block; animation: fadeIn 0.3s; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: #222;
            border: 1px solid #333;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            border: none;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
            font-size: 14px;
            display: flex; justify-content: center; align-items: center; gap: 8px;
        }
        .btn-yellow { background: #eab308; color: #000; box-shadow: 0 0 15px rgba(234, 179, 8, 0.3); }
        .btn-red { background: #ef4444; color: #fff; box-shadow: 0 0 15px rgba(239, 68, 68, 0.3); }
        .btn-outline { background: transparent; border: 1px solid #333; color: #888; }
        .btn-sm { padding: 8px; font-size: 12px; width: auto; }

        /* –°–µ—Ç–∫–∞ —Å–∞–π—Ç–æ–≤ */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .site-btn {
            background: #1a1a1a; border: 1px solid #333;
            border-radius: 12px; height: 80px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s;
        }
        .site-btn.active { border-color: #eab308; background: #2a2a2a; }
        .site-btn h2 { margin: 0; font-size: 24px; }
        .site-btn span { font-size: 10px; text-transform: uppercase; color: #666; font-weight: bold; margin-top: 4px; }

        /* –ú–µ–Ω—é */
        .nav {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: #111; border-top: 1px solid #333;
            display: flex; justify-content: space-around;
            padding: 15px 0;
        }
        .nav-item { background: none; border: none; color: #555; font-size: 10px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .nav-item.active { color: #eab308; }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 100;
            display: none;
        }
        .modal { background: #222; padding: 20px; border-radius: 20px; width: 80%; border: 1px solid #444; text-align: center; }
        
        /* –ò–Ω–ø—É—Ç—ã */
        input { background: #000; border: 1px solid #444; color: #fff; padding: 12px; border-radius: 8px; width: 100%; box-sizing: border-box; outline: none; margin-bottom: 10px; }
        input:focus { border-color: #eab308; }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ */
        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #1a1a1a; border-radius: 8px; margin-bottom: 8px; border: 1px solid #333; }
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: bold; }
        .badge-green { background: #064e3b; color: #34d399; }
        .del-btn { color: #ef4444; font-weight: bold; cursor: pointer; padding: 5px; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="app">

    <div id="tab-studio" class="content active">
        <div class="card" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; gap: 12px; align-items: center;">
                <div style="width: 40px; height: 40px; background: #333; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800;">K</div>
                <div>
                    <div style="font-weight: 800; font-size: 18px;">PRIMA</div>
                    <div style="font-size: 11px; color: #888;">–ü–∞–Ω–µ–ª—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞</div>
                </div>
            </div>
            <div style="color: #4ade80; font-weight: 900;">$ <span id="header-balance">0</span></div>
        </div>

        <div id="state-start">
            <div style="text-align: center; color: #666; font-size: 12px; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–æ—â–∞–¥–∫–∏</div>
            
            <div class="grid-2">
                <div class="site-btn active" onclick="toggleSite(this)">
                    <h2 style="color: #eab308">C</h2><span>Chaturbate</span>
                </div>
                <div class="site-btn active" onclick="toggleSite(this)">
                    <h2 style="color: #ef4444">S</h2><span>Stripchat</span>
                </div>
                <div class="site-btn" onclick="toggleSite(this)">
                    <h2 style="color: #3b82f6">C</h2><span>CamSoda</span>
                </div>
                <div class="site-btn" onclick="toggleSite(this)">
                    <h2 style="color: #ec4899">C</h2><span>Cum4K</span>
                </div>
                <div class="site-btn" style="grid-column: span 2;" onclick="toggleSite(this)">
                    <h2 style="color: #a855f7">J</h2><span>Jasmin</span>
                </div>
            </div>

            <button class="btn btn-yellow" onclick="startShift()">–ù–ê–ß–ê–¢–¨ –°–ú–ï–ù–£</button>
        </div>

        <div id="state-active" class="hidden">
            <div class="card" style="text-align: center; border-color: #eab308;">
                <div style="color: #eab308; font-size: 10px; font-weight: 900; letter-spacing: 2px; margin-bottom: 10px;">–≠–§–ò–† –ò–î–ï–¢</div>
                <div id="timer" style="font-size: 48px; font-weight: 900; font-family: monospace;">00:00:00</div>
            </div>

            <div class="card">
                <div style="font-size: 12px; color: #888; margin-bottom: 10px; font-weight: bold;">–ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† (–î–õ–Ø –°–ï–ë–Ø)</div>
                <div style="display: flex; gap: 10px;">
                    <input type="number" id="calc-tk" placeholder="–¢–æ–∫–µ–Ω—ã" oninput="calcUsd()">
                    <div id="calc-res" style="background: #333; padding: 12px; border-radius: 8px; min-width: 80px; text-align: center; font-weight: bold; color: #4ade80;">$0</div>
                </div>
            </div>

            <button class="btn btn-red" onclick="showFinishModal()">–ó–ê–ö–û–ù–ß–ò–¢–¨ –°–ú–ï–ù–£</button>
        </div>
    </div>

    <div id="tab-plan" class="content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h2 style="margin: 0;">–ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω</h2>
            <button class="btn btn-sm btn-yellow" onclick="addTask()">+ –î–û–ë–ê–í–ò–¢–¨</button>
        </div>
        <div id="task-list">
            </div>

        <h2 style="margin: 20px 0 15px;">–ò—Å—Ç–æ—Ä–∏—è —Å–º–µ–Ω</h2>
        <div id="history-list">
            <div style="text-align: center; color: #444; padding: 20px;">–ò—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç</div>
        </div>
    </div>

    <div id="tab-cabinet" class="content">
        <div class="card" style="text-align: center; padding: 30px;">
            <div style="width: 80px; height: 80px; background: #eab308; border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 32px; color: #000; font-weight: 900;">K</div>
            <h2 style="margin: 0 0 5px;">keikiiiii</h2>
            <span style="color: #eab308; border: 1px solid #eab308; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: bold;">–û–ü–ï–†–ê–¢–û–†</span>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
            <div class="card" style="text-align: center; padding: 15px;">
                <div style="font-size: 12px; color: #888;">–í—Å–µ–≥–æ —Å–º–µ–Ω</div>
                <div style="font-size: 24px; font-weight: bold;" id="stats-shifts">0</div>
            </div>
            <div class="card" style="text-align: center; padding: 15px;">
                <div style="font-size: 12px; color: #888;">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                <div style="font-size: 24px; font-weight: bold; color: #4ade80;" id="stats-money">$0</div>
            </div>
        </div>

        <button id="admin-panel-btn" class="btn btn-outline hidden" style="margin-bottom: 20px; color: #f87171; border-color: #f87171;" onclick="toggleAdminPanel()">üõ† –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê</button>

        <h3 style="color: #888; font-size: 12px; margin-bottom: 10px;">–£–ß–ï–¢–ù–´–ï –ó–ê–ü–ò–°–ò (–†–ï–î–ê–ö–¢–ò–†–£–ï–¢–°–Ø –ê–î–ú–ò–ù–û–ú)</h3>
        <div id="credentials-list">
            </div>
    </div>

    <div id="modal-finish" class="modal-overlay">
        <div class="modal">
            <h2 style="margin-top: 0;">–ò–¢–û–ì–ò –°–ú–ï–ù–´</h2>
            <div style="font-size: 12px; color: #888; margin-bottom: 15px;">–í–≤–µ–¥–∏—Ç–µ –∑–∞—Ä–∞–±–æ—Ç–æ–∫ –∑–∞ —Å–º–µ–Ω—É (–≤ —Ç–æ–∫–µ–Ω–∞—Ö)</div>
            
            <input type="number" id="finish-tokens" placeholder="–í—Å–µ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤ (TK)">
            <input type="number" id="finish-usd" placeholder="–°—É–º–º–∞ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö ($)" readonly style="background: #111; color: #4ade80; font-weight: bold;">
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-outline" onclick="closeFinishModal()">–û–¢–ú–ï–ù–ê</button>
                <button class="btn btn-yellow" onclick="saveShift()">–°–û–•–†–ê–ù–ò–¢–¨</button>
            </div>
        </div>
    </div>

    <div class="nav">
        <button class="nav-item active" onclick="switchTab('tab-studio', this)">–°–¢–£–î–ò–Ø</button>
        <button class="nav-item" onclick="switchTab('tab-plan', this)">–ü–õ–ê–ù</button>
        <button class="nav-item" onclick="switchTab('tab-cabinet', this)">–ö–ê–ë–ò–ù–ï–¢</button>
    </div>

</div>

<script>
    // === –î–ê–ù–ù–´–ï –ò –ù–ê–°–¢–†–û–ô–ö–ò ===
    const ADMIN_ID = 957837867;
    let startTime, timerInt;
    let shifts = JSON.parse(localStorage.getItem('shifts')) || [];
    let tasks = JSON.parse(localStorage.getItem('tasks')) || ['–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–µ—Ç', '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å OBS'];
    
    // –î–∞–Ω–Ω—ã–µ –ª–æ–≥–∏–Ω–æ–≤ (–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    let credentials = JSON.parse(localStorage.getItem('credentials')) || {
        'Chaturbate': { l: '', p: '' },
        'Stripchat': { l: '', p: '' },
        'CamSoda': { l: '', p: '' },
        'Cum4K': { l: '', p: '' },
        'Jasmin': { l: '', p: '' }
    };

    // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
    const tg = window.Telegram.WebApp;
    tg.ready(); tg.expand(); tg.setHeaderColor('#000000');

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞
    if (tg.initDataUnsafe?.user?.id === ADMIN_ID) {
        document.getElementById('admin-panel-btn').classList.remove('hidden');
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    renderTasks();
    renderHistory();
    renderStats();
    renderCredentials();

    // === –§–£–ù–ö–¶–ò–ò –°–ú–ï–ù–´ ===
    function toggleSite(el) { el.classList.toggle('active'); }

    function startShift() {
        document.getElementById('state-start').classList.add('hidden');
        document.getElementById('state-active').classList.remove('hidden');
        startTime = new Date();
        timerInt = setInterval(() => {
            let diff = new Date(new Date() - startTime);
            document.getElementById('timer').innerText = diff.toISOString().substr(11, 8);
        }, 1000);
    }

    function showFinishModal() {
        document.getElementById('modal-finish').style.display = 'flex';
    }

    function closeFinishModal() {
        document.getElementById('modal-finish').style.display = 'none';
    }

    // –ê–≤—Ç–æ-—Ä–∞—Å—á–µ—Ç –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ –º–æ–¥–∞–ª–∫–µ (0.05 –∫—É—Ä—Å)
    document.getElementById('finish-tokens').addEventListener('input', function() {
        document.getElementById('finish-usd').value = (this.value * 0.05).toFixed(2);
    });

    function saveShift() {
        const tokens = document.getElementById('finish-tokens').value || 0;
        const usd = document.getElementById('finish-usd').value || 0;
        const duration = document.getElementById('timer').innerText;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        const shift = {
            date: new Date().toLocaleDateString(),
            time: new Date().toLocaleTimeString(),
            duration: duration,
            tokens: tokens,
            usd: usd
        };
        
        shifts.unshift(shift); // –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ
        localStorage.setItem('shifts', JSON.stringify(shifts));
        
        // –°–±—Ä–æ—Å
        clearInterval(timerInt);
        document.getElementById('state-active').classList.add('hidden');
        document.getElementById('state-start').classList.remove('hidden');
        document.getElementById('timer').innerText = '00:00:00';
        document.getElementById('finish-tokens').value = '';
        closeFinishModal();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        renderHistory();
        renderStats();
        alert('–°–º–µ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –≥—Ä–∞—Ñ–∏–∫!');
    }

    // === –§–£–ù–ö–¶–ò–ò –ü–õ–ê–ù–ê ===
    function renderTasks() {
        const list = document.getElementById('task-list');
        list.innerHTML = '';
        tasks.forEach((t, i) => {
            list.innerHTML += `
                <div class="list-item">
                    <span>${t}</span>
                    <span class="del-btn" onclick="removeTask(${i})">‚úñ</span>
                </div>`;
        });
    }

    function addTask() {
        const t = prompt('–í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á—É:');
        if(t) {
            tasks.push(t);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            renderTasks();
        }
    }

    function removeTask(i) {
        tasks.splice(i, 1);
        localStorage.setItem('tasks', JSON.stringify(tasks));
        renderTasks();
    }

    function renderHistory() {
        const list = document.getElementById('history-list');
        if (shifts.length === 0) return;
        list.innerHTML = '';
        shifts.forEach(s => {
            list.innerHTML += `
                <div class="card" style="padding: 12px; border-left: 4px solid #eab308;">
                    <div style="display:flex; justify-content:space-between; font-weight:bold; margin-bottom:5px;">
                        <span>${s.date}</span>
                        <span style="color:#4ade80;">$${s.usd}</span>
                    </div>
                    <div style="font-size:12px; color:#888;">
                        –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${s.duration} | –¢–æ–∫–µ–Ω—ã: ${s.tokens}
                    </div>
                </div>`;
        });
    }

    function renderStats() {
        document.getElementById('stats-shifts').innerText = shifts.length;
        let total = shifts.reduce((acc, curr) => acc + parseFloat(curr.usd), 0);
        document.getElementById('stats-money').innerText = '$' + total.toFixed(2);
        document.getElementById('header-balance').innerText = total.toFixed(2);
    }

    // === –§–£–ù–ö–¶–ò–ò –ö–ê–ë–ò–ù–ï–¢–ê (–ü–ê–†–û–õ–ò) ===
    function renderCredentials() {
        const list = document.getElementById('credentials-list');
        list.innerHTML = '';
        for (const [site, data] of Object.entries(credentials)) {
            list.innerHTML += `
                <div class="card" style="padding: 10px;">
                    <div style="font-weight:bold; color:#eab308; margin-bottom:5px;">${site}</div>
                    <input type="text" placeholder="–õ–æ–≥–∏–Ω" value="${data.l}" oninput="updateCred('${site}', 'l', this.value)">
                    <input type="text" placeholder="–ü–∞—Ä–æ–ª—å" value="${data.p}" oninput="updateCred('${site}', 'p', this.value)">
                </div>`;
        }
    }

    function updateCred(site, type, val) {
        credentials[site][type] = val;
        localStorage.setItem('credentials', JSON.stringify(credentials));
    }

    // === –ù–ê–í–ò–ì–ê–¶–ò–Ø ===
    function switchTab(id, btn) {
        document.querySelectorAll('.content').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        btn.classList.add('active');
    }

    // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä (—Å—Ç—É–¥–∏—è)
    function calcUsd() {
        let val = (document.getElementById('calc-tk').value * 0.05).toFixed(2);
        document.getElementById('calc-res').innerText = '$' + val;
    }
</script>

</body>
</html>
