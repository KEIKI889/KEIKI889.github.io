<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PRIMA Studio</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            background-color: #000000;
            color: #ffffff;
            font-family: system-ui, -apple-system, sans-serif;
            overflow: hidden;
            margin: 0;
            padding: 0;
            touch-action: manipulation; /* Улучшает отклик на телефоне */
        }
        /* Анимация загрузки */
        .loader {
            border: 3px solid #333;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.555.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/"
  }
}
</script>
</head>
<body>

    <div id="root">
        <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh;">
            <div class="loader"></div>
            <p style="margin-top:20px; color:#666;">Запуск PRIMA...</p>
        </div>
    </div>

    <script type="text/babel">
        // Безопасное получение переменных React
        const { useState, useEffect } = React;
        
        function App() {
            const [userName, setUserName] = useState('Гость');
            const [activeTab, setActiveTab] = useState('home');

            useEffect(() => {
                // Пытаемся инициализировать иконки, если библиотека загрузилась
                if (window.lucide) window.lucide.createIcons();

                // Инициализация Телеграма
                if (window.Telegram && window.Telegram.WebApp) {
                    const tg = window.Telegram.WebApp;
                    tg.ready();
                    tg.expand(); // Раскрыть на весь экран
                    
                    // Красим шапку телеграма в черный
                    try { tg.setHeaderColor('#000000'); } catch(e) {}

                    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                        setUserName(tg.initDataUnsafe.user.first_name);
                    }
                }
            }, []);

            // Компоненты иконок (SVG) вручную, чтобы точно не сломалось
            const IconHome = () => (
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            );
            const IconCamera = () => (
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
            );
            const IconUser = () => (
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            );
            const IconZap = () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
            );

            return (
                <div className="flex flex-col h-screen bg-black text-white">
                    
                    {/* ОСНОВНОЙ КОНТЕНТ */}
                    <div className="flex-1 overflow-y-auto p-4 pb-24">
                        
                        {/* Экран: Главная */}
                        {activeTab === 'home' && (
                            <div className="space-y-6 animate-fade-in">
                                <header className="flex justify-between items-center mt-2">
                                    <h1 className="text-2xl font-bold tracking-tight">PRIMA <span className="text-blue-500">APP</span></h1>
                                    <div className="bg-zinc-800 p-2 rounded-full border border-zinc-700">
                                        <IconUser />
                                    </div>
                                </header>

                                <div className="bg-gradient-to-br from-blue-900 via-blue-950 to-black p-6 rounded-2xl border border-blue-800/50 shadow-lg shadow-blue-900/20">
                                    <h2 className="text-xl font-bold mb-1">Привет, {userName}!</h2>
                                    <p className="text-blue-200 text-sm">Система работает стабильно.</p>
                                </div>

                                <div>
                                    <h3 className="text-zinc-400 text-sm font-medium mb-3 uppercase tracking-wider">Инструменты</h3>
                                    <div className="grid grid-cols-2 gap-3">
                                        {['AI Чат', 'Генерация', 'История', 'Баланс'].map((item) => (
                                            <button key={item} className="bg-zinc-900 hover:bg-zinc-800 border border-zinc-800 p-4 rounded-xl flex flex-col items-center justify-center gap-2 transition-all active:scale-95 h-24">
                                                <div className="text-yellow-500"><IconZap /></div>
                                                <span className="text-sm font-medium text-zinc-300">{item}</span>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Экран: Студия */}
                        {activeTab === 'studio' && (
                            <div className="flex flex-col items-center justify-center h-[60vh] text-zinc-500 space-y-4">
                                <div className="w-20 h-20 bg-zinc-900 rounded-full flex items-center justify-center">
                                    <IconCamera />
                                </div>
                                <p>Раздел Студия скоро появится</p>
                            </div>
                        )}

                        {/* Экран: Профиль */}
                        {activeTab === 'profile' && (
                            <div className="flex flex-col items-center justify-center h-[60vh] text-zinc-500 space-y-4">
                                <div className="w-20 h-20 bg-zinc-900 rounded-full flex items-center justify-center">
                                    <IconUser />
                                </div>
                                <p>Настройки профиля</p>
                            </div>
                        )}
                    </div>

                    {/* НИЖНЕЕ МЕНЮ (TAB BAR) */}
                    <div className="fixed bottom-0 w-full bg-black/90 backdrop-blur-md border-t border-zinc-800 pb-safe">
                        <div className="flex justify-around items-center py-3">
                            <button onClick={() => setActiveTab('home')} className={`flex flex-col items-center space-y-1 w-16 ${activeTab === 'home' ? 'text-blue-500' : 'text-zinc-500'}`}>
                                <IconHome />
                                <span className="text-[10px]">Главная</span>
                            </button>
                            
                            <button onClick={() => setActiveTab('studio')} className={`flex flex-col items-center space-y-1 w-16 ${activeTab === 'studio' ? 'text-blue-500' : 'text-zinc-500'}`}>
                                <IconCamera />
                                <span className="text-[10px]">Студия</span>
                            </button>
                            
                            <button onClick={() => setActiveTab('profile')} className={`flex flex-col items-center space-y-1 w-16 ${activeTab === 'profile' ? 'text-blue-500' : 'text-zinc-500'}`}>
                                <IconUser />
                                <span className="text-[10px]">Профиль</span>
                            </button>
                        </div>
                        <div className="h-6"></div> 
                    </div>

                </div>
            );
        }

        // Запуск
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>